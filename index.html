<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>HDLM: Unifying Autoregressive and Diffusion-Based Sequence Generation</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Font Awesome Icons -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
      rel="stylesheet"
    />
    <!-- Your Custom Styles -->
    <link rel="stylesheet" href="style.css" />
  </head>

  <body id="top" data-bs-spy="scroll" data-bs-target="#navbarNav" data-bs-smooth-scroll="true">
    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg sticky-top custom-navbar">
      <div class="container">
        <a class="navbar-brand" href="#top">
          <img src="images/ServiceNow-Logo-2022_400x200.png" class="nav-logo" alt="ServiceNow" />
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
          <ul class="navbar-nav gap-4">
            <li class="nav-item">
              <a class="nav-link" href="#abstract">
                <i class="fas fa-book-open"></i> Abstract
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#method">
                <i class="fas fa-cogs"></i> Method
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#efficiency">
                <i class="fas fa-tachometer-alt"></i> Efficiency
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#results">
                <i class="fas fa-chart-bar"></i> Results
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#inference">
                <i class="fas fa-wrench"></i> Inference
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#examples">
                <i class="fas fa-file-alt"></i> Examples
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#bibtex">
                <i class="fas fa-quote-right"></i> Citation
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- HEADER -->
    <header class="custom-header fade-in">
      <div class="container text-center">
        <h1 class="h3 fw-semibold">
          HDLM: Unifying Autoregressive and Diffusion-Based Sequence Generation
        </h1>
        <div class="row justify-content-center my-3">
          <div class="col-6 col-md-3 text-center">
            <strong>
              <a href="https://nimafathi.github.io/" class="author-link" target="_blank">
                Nima Fathi
              </a>
            </strong><br />
            <small class="text-white-50">
              Mila – Quebec AI Institute,<br />ServiceNow Research
            </small>
          </div>
          <div class="col-6 col-md-3 text-center">
            <strong>
              <a
                href="https://www.servicenow.com/research/author/pierre-andre-noel.html"
                class="author-link"
                target="_blank"
              >
                Pierre-André Noël
              </a>
            </strong><br />
            <small class="text-white-50">ServiceNow Research</small>
          </div>
          <div class="col-6 col-md-3 text-center">
            <strong>
              <a href="https://tscholak.github.io/" class="author-link" target="_blank">
                Torsten Scholak
              </a>
            </strong><br />
            <small class="text-white-50">ServiceNow Research</small>
          </div>
        </div>
        <p class="workshop-name">COLM 2025</p>

        <div class="button-group">
          <a
            class="custom-btn"
            href="https://arxiv.org/abs/2504.06416"
            target="_blank"
            rel="noopener noreferrer"
          >
            <i class="fas fa-file-alt me-2"></i> arXiv
          </a>
          <a
            class="custom-btn"
            href="https://huggingface.co/your-username/your-model-repo"
            target="_blank"
            rel="noopener noreferrer"
          >
            <img
              src="images/huggingface_logo-noborder.svg"
              width="20"
              class="me-2"
              alt="Hugging Face"
            />
            Weights
          </a>
          <a
            class="custom-btn"
            href="https://github.com/servicenow/hdlm"
            target="_blank"
            rel="noopener noreferrer"
          >
            <i class="fab fa-github me-2"></i> Code
          </a>
          <a
            class="custom-btn"
            href="https://nimafathi.github.io/blog/2025/unifying-ar-diffusion/"
            target="_blank"
            rel="noopener noreferrer"
          >
            <i class="fas fa-blog me-2"></i> Blog
          </a>
        </div>
      </div>
    </header>

    <!-- TEASER FIGURE -->
    <div class="container-lg text-center fade-in">
      <img
        src="images/hybrid_process.png"
        class="img-fluid teaser-img mb-3"
        alt="Hybrid Noising Process"
      />
      <p class="text-muted small">
        <strong>Figure:</strong> Hybrid Noising Process illustrating how HDLM
        interpolates between autoregressive (absorb) and diffusion (uniform)
        steps via per-token hyperschedules.
      </p>
    </div>

    <div class="container-lg">
      <!-- ABSTRACT -->
      <section id="abstract" class="fade-in">
        <h2>Abstract</h2>
        <p>
          We present significant extensions to diffusion-based sequence
          generation models, blurring the line with autoregressive language
          models. We introduce <em>hyperschedules</em>, which assign distinct
          noise schedules to individual token positions, generalizing both
          autoregressive models (e.g., GPT) and conventional diffusion models
          (e.g., SEDD, MDLM) as special cases. We also propose two hybrid
          token-wise noising processes that interpolate between absorbing and
          uniform processes—enabling the model to fix past mistakes—and a novel
          inference algorithm that leverages this new feature. To support
          efficient training and inference, we design attention masks compatible
          with KV-caching. Our methods achieve state-of-the-art perplexity and
          generate diverse, high-quality sequences across standard benchmarks,
          suggesting a promising path for autoregressive diffusion-based
          sequence generation.
        </p>
      </section>

      <!-- METHOD -->
      <section id="method" class="fade-in">
        <h2>Method</h2>
        <p>
          HDLM introduces the concept of a <em>hyperschedule</em>: a per-token
          noise schedule that can recover both autoregressive and diffusion
          behaviors.
        </p>
        <ul>
          <li>
            <strong>Hyperschedules:</strong> Learn per-step noise fractions that
            morph between AR and diffusion.
          </li>
          <li>
            <strong>Hybrid Processes:</strong> Combine “absorb” (mask) and
            “uniform” noising for corrective denoising.
          </li>
          <li>
            <strong>Adaptive Correction Sampler:</strong> Leverage confidence to
            iteratively refine early mistakes.
          </li>
        </ul>
        <div class="row">
          <div class="col-md-10 offset-md-1">
            <img
              src="images/hyperschedule_panels.png"
              class="img-fluid fade-in rounded"
              alt="Hyperschedule Panels"
            />
            <p class="text-muted small text-center mt-2">
              <strong>Figure:</strong> Four example hyperschedules—
              (a) Quenched (AR), (b) Flat diffusion, (c) Block annealing,
              (d) Slide annealing.
            </p>
          </div>
        </div>
      </section>

      <!-- EFFICIENCY -->
      <section id="efficiency" class="fade-in">
        <h2>Efficiency via Attention Masks</h2>
        <p>
          To avoid recomputing settled tokens, HDLM uses:
        </p>
        <ul>
          <li><strong>KV-Caching:</strong> Cache key/value pairs of settled tokens.</li>
          <li>
            <strong>Token Partitioning:</strong> Split tokens into
            <em>settled</em>, <em>active</em>, and <em>worthless</em>.
          </li>
        </ul>
        <p>Two inference modes:</p>
        <ul>
          <li>
            <strong>Aligned (MLM-style):</strong> Active tokens attend to themselves
            and all settled ones.
          </li>
          <li>
            <strong>Shifted (AR-style):</strong> Each new token attends only to
            previously settled tokens.
          </li>
        </ul>
        <div class="row">
          <div class="col-md-10 offset-md-1">
            <img
              src="images/attention_mask.jpg"
              class="img-fluid fade-in rounded"
              alt="Attention Masks"
            />
            <p class="text-muted small text-center mt-2">
              <strong>Figure:</strong> Training attention masks for aligned
              (striped+solid) and shifted (solid only) modes.
            </p>
          </div>
        </div>
      </section>

      <!-- RESULTS -->
      <section id="results" class="fade-in">
        <h2>Results: Pareto Front & Zero-Shot Perplexity</h2>

        <!-- If you only have one merged image, put it in a centered col -->
        <div class="row mb-4 justify-content-center">
            <div class="col-lg-8 text-center">
            <img
                src="images/pareto_front.png"
                class="img-fluid rounded"
                alt="Pareto Front: entropy vs perplexity and MAUVE vs perplexity"
            />
            </div>
        </div>

        <p class="text-muted">
            HDLM variants (green) lie on the Pareto frontier, offering lower
            GPT-2-judged perplexity at matched or higher diversity than other diffusion-LLM baselines.
        </p>

        <!-- Zero-Shot Table -->
        <div class="table-responsive mb-3">
            <table class="table table-bordered table-striped">
            <thead class="table-light">
                <tr>
                <th>Method</th>
                <th>WikiText</th>
                <th>LAMBADA</th>
                <th>PubMed</th>
                <th>arXiv</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                <td>Transformer (Sahoo<em>et al.</em>)</td>
                <td>25.8</td><td>51.3</td><td>49.0</td><td>41.7</td>
                </tr>
                <tr>
                <td>SEDD (Lou<em>et al.</em>)</td>
                <td>36.0</td><td>48.9</td><td>45.4</td><td>40.0</td>
                </tr>
                <tr>
                <td>MDLM (Sahoo<em>et al.</em>)</td>
                <td>33.2</td><td>48.3</td><td>43.1</td><td>37.9</td>
                </tr>
                <tr>
                <td>BD3-LM (Arriola<em>et al.</em>)</td>
                <td>31.3</td><td>50.0</td><td>42.5</td><td>39.2</td>
                </tr>
                <tr class="table-success">
                <td>γ-Hybrid (Ours)</td>
                <td>30.0</td>
                <td><strong>45.4</strong></td>
                <td>46.6</td>
                <td>40.6</td>
                </tr>
                <tr class="table-success">
                <td>ε-Hybrid (Ours)</td>
                <td>32.5</td>
                <td>50.2</td>
                <td><strong>41.2</strong></td>
                <td><strong>37.8</strong></td>
                </tr>
            </tbody>
            </table>
        </div>
        </section>
      <!-- INFERENCE -->
      <section id="inference" class="fade-in">
        <h2>Inference: Adaptive Correction Sampler (ACS)</h2>
        <p>
          Traditional AR decoding cannot revise past tokens. ACS breaks this by
          iteratively refining low-confidence predictions, controlled by
          hyperparameter &eta;.
        </p>
        <div class="table-responsive mb-3">
          <table class="table table-bordered table-striped">
            <thead class="table-light">
              <tr>
                <th rowspan="2">Sampler</th>
                <th colspan="4">MAUVE ↑</th>
                <th colspan="4">Gen. PPL ↓</th>
                <th colspan="4">Entropy ↑</th>
              </tr>
              <tr>
                <th>ρ=8</th>
                <th>ρ=4</th>
                <th>ρ=2</th>
                <th>ρ=1</th>
                <th>ρ=8</th>
                <th>ρ=4</th>
                <th>ρ=2</th>
                <th>ρ=1</th>
                <th>ρ=8</th>
                <th>ρ=4</th>
                <th>ρ=2</th>
                <th>ρ=1</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Original</td>
                <td>0.950</td>
                <td>0.944</td>
                <td>0.848</td>
                <td>0.779</td>
                <td>130.8</td>
                <td>124.8</td>
                <td>121.9</td>
                <td>129.5</td>
                <td>5.51</td>
                <td>5.47</td>
                <td>5.49</td>
                <td>5.50</td>
              </tr>
              <tr class="table-success">
                <td>ACS (&eta;=0.25)</td>
                <td>0.955</td>
                <td>0.821</td>
                <td>0.859</td>
                <td>0.928</td>
                <td><strong>79.64</strong></td>
                <td>65.06</td>
                <td>55.05</td>
                <td>49.09</td>
                <td>5.35</td>
                <td>5.28</td>
                <td>5.24</td>
                <td>5.19</td>
              </tr>
              <!-- …additional η rows… -->
            </tbody>
          </table>
        </div>
      </section>

      <!-- GENERATION LOOP -->
      <section id="gen-loop" class="fade-in">
        <h2>Autoregressive–Diffusion Inference Loop</h2>
        <p>Each step consists of:</p>
        <ol>
          <li><code>logits = model(window, cache)</code></li>
          <li><code>window, new_settled = sample(window, logits)</code></li>
          <li><code>cache = update(cache, new_settled)</code></li>
        </ol>
        <div class="text-center">
          <img
            src="images/generation_alg.png"
            class="img-fluid rounded"
            alt="Generation Algorithm"
          />
          <p class="text-muted small mt-2">
            <strong>Figure:</strong> Code + visual grid showing how the window & cache
            evolve across iterations.
          </p>
        </div>
      </section>

      <!-- EXAMPLES -->
      <section id="examples" class="fade-in">
        <h2>Interactive Generation Examples</h2>

        <!-- Nav tabs -->
        <ul class="nav nav-pills mb-3 justify-content-center" id="examplesTabs" role="tablist">
            <li class="nav-item" role="presentation">
            <button
                class="nav-link active"
                id="ex1-tab"
                data-bs-toggle="pill"
                data-bs-target="#ex1"
                type="button"
                role="tab"
                aria-controls="ex1"
                aria-selected="true"
            >
                Example 1
            </button>
            </li>
            <li class="nav-item" role="presentation">
            <button
                class="nav-link"
                id="ex2-tab"
                data-bs-toggle="pill"
                data-bs-target="#ex2"
                type="button"
                role="tab"
                aria-controls="ex2"
                aria-selected="false"
            >
                Example 2
            </button>
            </li>
            <!-- add more tabs as needed -->
        </ul>

        <!-- Tab panes -->
        <div class="tab-content">
            <div
            class="tab-pane fade show active"
            id="ex1"
            role="tabpanel"
            aria-labelledby="ex1-tab"
            >
            <p>
                <!-- action_point: Paste Example 1 continuation here -->
                Once upon a midnight dreary, while I pondered, weak and weary... 
                <!-- example of conditional snippet: -->
                <span class="conditional-text">[Condition: prompt = “continue Poe style”]</span>
            </p>
            </div>

            <div
            class="tab-pane fade"
            id="ex2"
            role="tabpanel"
            aria-labelledby="ex2-tab"
            >
            <p>
                <!-- action_point: Paste Example 2 continuation here -->
                In a future where AI writes poetry, the silicon ink...</p>
                <span class="conditional-text">[Condition: prompt = “futuristic tone”]</span>
            </p>
            </div>

            <!-- add more panes (#ex3, #ex4, …) exactly matching your nav-pills above -->
        </div>
        </section>
      <!-- CITATION -->
      <section id="bibtex" class="fade-in">
        <h2>Citation</h2>
        <pre class="bg-light p-3 rounded">
        @article{fathi2025unifying,
        title={Unifying autoregressive and diffusion-based sequence generation},
        author={Fathi, Nima and Scholak, Torsten and Noël, Pierre-André},
        journal={arXiv preprint arXiv:2504.06416},
        year={2025}
        }</pre>
      </section>
    </div>

    <!-- FOOTER -->
    <footer class="custom-footer text-center py-4">
      <div class="footer-box">© Nima Fathi | COLM 2025</div>
    </footer>

    <!-- Bootstrap JS + Fade-in Observer -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll("section").forEach((sec) => {
          const obs = new IntersectionObserver(
            (entries) =>
              entries.forEach((e) =>
                e.isIntersecting
                  ? e.target.classList.add("visible")
                  : e.target.classList.remove("visible")
              ),
            { threshold: 0.1 }
          );
          obs.observe(sec);
        });
      });
    </script>
  </body>
</html>